<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neon Dash X</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:black;
    font-family:Arial;
    touch-action: manipulation;
}

canvas{ display:none; }

#loadingScreen{
    position:absolute;
    width:100%;
    height:100%;
    background:black;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    color:white;
}

#loadingBar{
    width:250px;
    height:10px;
    border:2px solid #ff00ff;
    margin-top:20px;
    box-shadow:0 0 15px #ff00ff;
}

#loadingProgress{
    height:100%;
    width:0%;
    background:#ff00ff;
    box-shadow:0 0 20px #ff00ff;
}

#menu{
    position:absolute;
    width:100%;
    height:100%;
    display:none;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    color:white;
    text-align:center;
}

button{
    padding:15px 40px;
    font-size:20px;
    background:#ff00ff;
    border:none;
    border-radius:10px;
    color:white;
    cursor:pointer;
    box-shadow:0 0 20px #ff00ff;
}
</style>
</head>
<body>

<div id="loadingScreen">
    <h1 style="text-shadow:0 0 20px #ff00ff;">âš¡ LOADING NEON DASH X âš¡</h1>
    <div id="loadingBar">
        <div id="loadingProgress"></div>
    </div>
</div>

<div id="menu">
<h1>âš¡ NEON DASH X âš¡</h1>
<h2 id="highScoreText"></h2>
<button onclick="startGame()">START</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menu = document.getElementById("menu");
const highScoreText = document.getElementById("highScoreText");
const loadingScreen = document.getElementById("loadingScreen");
const loadingProgress = document.getElementById("loadingProgress");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
window.addEventListener("resize", ()=>{
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});

let gravity, speed, score, stage;
let player, obstacles;
let shakeTime, flashAlpha;
let hue = 0;
let gameOver = false;

let highScore = localStorage.getItem("neonDashHighScore") || 0;
highScoreText.innerText = "ðŸ† Highest Score: " + highScore;

/* ---------------- LOADING ANIMATION ---------------- */

let loadPercent = 0;
let loadInterval = setInterval(()=>{
    loadPercent += 2;
    loadingProgress.style.width = loadPercent + "%";

    if(loadPercent >= 100){
        clearInterval(loadInterval);
        setTimeout(()=>{
            loadingScreen.style.display="none";
            menu.style.display="flex";
        },400);
    }
},30);

/* ---------------- GAME INIT ---------------- */

function init(){
gravity = 0.8;
speed = 6;
score = 0;
stage = 1;
shakeTime = 0;
flashAlpha = 0;
hue = 0;
gameOver = false;

player = {
x:150,
y:canvas.height-140,
w:40,
h:40,
dy:0,
jumpCount:0,
rotation:0
};

obstacles = [];
}

function startGame(){
menu.style.display="none";
canvas.style.display="block";
init();
update();
}

function returnMenu(){
canvas.style.display="none";
menu.style.display="flex";
highScoreText.innerText="ðŸ† Highest Score: "+highScore;
}

/* ---------------- DRAW BACKGROUND ---------------- */

function drawBackground(){
hue += 0.8;

let g = ctx.createLinearGradient(0,0,0,canvas.height);
g.addColorStop(0,`hsl(${hue},90%,30%)`);
g.addColorStop(1,`hsl(${hue+60},90%,15%)`);

ctx.fillStyle = g;
ctx.fillRect(0,0,canvas.width,canvas.height);

ctx.strokeStyle=`hsl(${hue},100%,60%)`;
ctx.lineWidth=5;
ctx.shadowBlur=25;
ctx.shadowColor=`hsl(${hue},100%,60%)`;
ctx.beginPath();
ctx.moveTo(0,canvas.height-100);
ctx.lineTo(canvas.width,canvas.height-100);
ctx.stroke();
ctx.shadowBlur=0;
}

/* ---------------- GAME LOOP ---------------- */

function spawnSpike(){
let gap = Math.max(260, 400 - stage*40);

if(obstacles.length===0 || canvas.width - obstacles[obstacles.length-1].x > gap){
let type = Math.random()>0.7 && stage>=3 ? "high":"low";
obstacles.push({
x:canvas.width,
type:type
});
}
}

function update(){

ctx.clearRect(0,0,canvas.width,canvas.height);

let shakeX=0, shakeY=0;
if(shakeTime>0){
shakeX=(Math.random()-0.5)*20;
shakeY=(Math.random()-0.5)*20;
shakeTime--;
}
ctx.save();
ctx.translate(shakeX,shakeY);

drawBackground();

if(!gameOver){

player.dy+=gravity;
player.y+=player.dy;

if(player.y>=canvas.height-140){
player.y=canvas.height-140;
player.dy=0;
player.jumpCount=0;
player.rotation=0;
}

if(player.dy!==0) player.rotation+=0.2;

score+=0.05;
speed+=0.002;

if(score>20) stage=2;
if(score>50) stage=3;
if(score>90) stage=4;
if(score>140) stage=5;

spawnSpike();
}

ctx.save();
ctx.translate(player.x+20,player.y+20);
ctx.rotate(player.rotation);
let cubeColor=`hsl(${hue+180},100%,60%)`;
ctx.shadowBlur=25;
ctx.shadowColor=cubeColor;
ctx.fillStyle=cubeColor;
ctx.fillRect(-20,-20,40,40);
ctx.restore();

obstacles.forEach(o=>{
o.x-=speed;
let spikeH=o.type==="high"?70:40;
let y=canvas.height-100;
let color=`hsl(${hue},100%,60%)`;

ctx.shadowBlur=20;
ctx.shadowColor=color;
ctx.fillStyle=color;

ctx.beginPath();
ctx.moveTo(o.x,y);
ctx.lineTo(o.x+40,y);
ctx.lineTo(o.x+20,y-spikeH);
ctx.closePath();
ctx.fill();
ctx.shadowBlur=0;

if(
player.x<o.x+40 &&
player.x+player.w>o.x &&
player.y+player.h>y-spikeH
){
if(!gameOver){
shakeTime=25;
flashAlpha=1;
gameOver=true;

if(Math.floor(score)>highScore){
highScore=Math.floor(score);
localStorage.setItem("neonDashHighScore",highScore);
}
setTimeout(returnMenu,900);
}
}
});

ctx.fillStyle="white";
ctx.font="20px Arial";
ctx.fillText("Score: "+Math.floor(score),20,40);
ctx.fillText("Stage: "+stage,20,70);

ctx.restore();

if(flashAlpha>0){
ctx.fillStyle=`rgba(255,255,255,${flashAlpha})`;
ctx.fillRect(0,0,canvas.width,canvas.height);
flashAlpha-=0.05;
}

if(!gameOver) requestAnimationFrame(update);
}

/* ---------------- INPUT ---------------- */

function jump(){
if(!gameOver && player.jumpCount < (stage>=3?2:1)){
player.dy=-16;
player.jumpCount++;
}
}

document.addEventListener("keydown", jump);
document.addEventListener("click", jump);
document.addEventListener("touchstart", jump);

</script>
</body>
</html>
